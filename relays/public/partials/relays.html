<div class="container">
    <div ng-if="!serverLinkOK()">
        <div class="row">
            <div class="alert alert-danger" role="alert">
                <span>
                    <h3>
                        Server link down ! <span am-time-ago="lastUpdate"></span>
                    </h3>
                    <button type="button" class="btn btn-default" ng-click="refresh()">
                        <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span>
                    </button>
                </span>
            </div>
        </div>
    </div>

    <div ng-repeat="r in relays">
        <div class="col-md-4">
            <div class="panel panel-primary" style="margin: 6px">
                <div class="panel-heading">
                    <h3 class="panel-title">Relay {{r.pin_id}}</h3>
                </div>
                <div class="panel-body">
                    <div class="btn-group" role="group" aria-label="...">
                        <button ng-if="r.state_str === 'on'" ng-click="setRelay(r.pin_id, 'off')" type="button" class="btn btn-success" aria-label="Left Align" ng-disabled="!r.on_user_override">
                            Activated
                        </button>
                        <button ng-if="r.state_str === 'off'" ng-click="setRelay(r.pin_id, 'on')" type="button" class="btn btn-danger" aria-label="Left Align" ng-disabled="!r.on_user_override">
                            Off
                        </button>
                        <button ng-if="r.on_user_override" ng-click="setRelay(r.pin_id, 'auto')" type="button" class="btn btn-warning" aria-label="Left Align">
                            Manual override
                        </button>
                        <button ng-if="!r.on_user_override" ng-click="setRelay(r.pin_id, r.state_str)" type="button" class="btn btn-primary" aria-label="Left Align">
                            Automatic
                        </button>
                    </div>
                </div>
            </div>
        </div>
        <div class="clearfix" ng-if="$index%3==2"></div>
    </div>
</div>
